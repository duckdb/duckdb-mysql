# name: test/sql/scan_text.test
# description: Test scanning tables with text
# group: [sql]

require mysql_scanner

require-env MYSQL_TEST_DATABASE_AVAILABLE

statement ok
ATTACH 'host=localhost user=root port=0 database=mysqlscanner' AS msql (TYPE MYSQL_SCANNER)

statement ok
USE msql

query III
SELECT * FROM text_tbl
----
ab  	ab	thisisalongstring
(empty)	(empty)	(empty)
		
NULL	NULL	NULL

query IIII
SELECT len(col1), len(col2), len(col3), len(col4) FROM text_long_tbl
----
63	64	65	66
63	64	66	65

query IIII
SELECT * FROM text_long_tbl
----
012345678901234567890123456789012345678901234567890123456789123	0123456789012345678901234567890123456789012345678901234567891234	01234567890123456789012345678901234567890123456789012345678912345	012345678901234567890123456789012345678901234567890123456789123456
012345678901234567890123456789012345678901234567890123456789123	0123456789012345678901234567890123456789012345678901234567891234	012345678901234567890123456789012345678901234567890123456789123456	01234567890123456789012345678901234567890123456789012345678912345

query I
SELECT * FROM json_tbl
----
{"k1": "value", "k2": 10}
["abc", 10, null, true, false]
NULL
