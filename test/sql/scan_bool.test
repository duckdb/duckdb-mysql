# name: test/sql/scan_bool.test
# description: Test scanning tables with booleans
# group: [sql]

require mysql_scanner

require-env MYSQL_TEST_DATABASE_AVAILABLE

statement ok
ATTACH 'host=localhost user=root port=0 database=mysqlscanner' AS msql (TYPE MYSQL_SCANNER)

statement ok
USE msql

query I
SELECT * FROM booleans
----
0
1
NULL

# check boolean roundtrip

statement ok
CREATE OR REPLACE TABLE scan_bool_1 (col1 INTEGER, col2 BOOLEAN)

query I
SELECT column_type FROM (
  DESCRIBE SELECT * FROM scan_bool_1
)
----
INTEGER
BOOLEAN

statement ok
INSERT INTO scan_bool_1 VALUES (1, TRUE), (2, FALSE), (3, 1), (4, 0)

query II
SELECT * FROM scan_bool_1
----
1	true
2	false
3	true
4	false

statement ok 
UPDATE scan_bool_1 SET col2 = FALSE WHERE col1 = 1

statement ok 
UPDATE scan_bool_1 SET col2 = TRUE WHERE col1 = 2

statement ok 
UPDATE scan_bool_1 SET col2 = 0 WHERE col1 = 3

statement ok 
UPDATE scan_bool_1 SET col2 = 1 WHERE col1 = 4

query II
SELECT * FROM scan_bool_1
----
1	false
2	true
3	false
4	true

statement ok
DROP TABLE IF EXISTS scan_bool_1
